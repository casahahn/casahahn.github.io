<!DOCTYPE html> 
<html> 

<head> 
	<title>Arithmetickle</title> 
	<script src= 
"https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.6.4/math.js"
		integrity= 
"sha512-BbVEDjbqdN3Eow8+empLMrJlxXRj5nEitiCAK5A1pUr66+jLVejo3PmjIaucRnjlB0P9R3rBUs3g5jXc8ti+fQ=="
		crossorigin="anonymous"
		referrerpolicy="no-referrer"></script> 
	<script src= 
"https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.6.4/math.min.js"
		integrity= 
"sha512-iphNRh6dPbeuPGIrQbCdbBF/qcqadKWLa35YPVfMZMHBSI6PLJh1om2xCTWhpVpmUyb4IvVS9iYnnYMkleVXLA=="
		crossorigin="anonymous"
		referrerpolicy="no-referrer"></script> 
	
	<style> 
		table { 
			border: 1px solid black; 
			margin-left: auto; 
			margin-right: auto; 
		} 

		input[type="button"] { 
			width: 100%; 
			padding: 20px 40px; 
			background-color: green; 
			color: white; 
			font-size: 24px; 
			font-weight: bold; 
			border: none; 
			border-radius: 5px; 
		} 
        input[type="buttonblue"] {
            width: 50%; 
			padding: 20px 40px; 
			background-color: #008CBA;; 
			color: white; 
			font-size: 18px; 
			font-weight: bold; 
			border: none; 
			border-radius: 5px; 
                    
        }

		input[type="text"] { 
			padding: 20px 30px; 
			font-size: 24px; 
			font-weight: bold; 
			border: none; 
			border-radius: 5px; 
			border: 2px solid black; 
		} 

	</style> 
</head> 
	
<body onload="makeProblem()">
	<h2 id=heading> Add, subtract, and/or multiple all 4 numbers to produce this answer </h2>
    <p></p>

	<table id="rslt"> 
		<tr>
            <td colspan="3"><input type="text" id="targetanswer"></td> 
		</tr>    
    <p></p>
	<table id="frm"> 
		<tr>
            <td colspan="3"><input type="text" id="problem"></td> 
		</tr> 
    </table>
	<table id="calcu"> 
		<tr id=numbuttons style='display:table-row;'> 
			<td><input type="button" id="but1" value="1" onclick="dis('1')" </td> 
			<td><input type="button" id="but2" value="2" onclick="dis('2')" </td> 
			<td><input type="button" id="but3" value="3" onclick="dis('3')" </td> 
			<td><input type="button" id="but4" value="4" onclick="dis('4')" </td> 
		</tr> 
		<tr id=oprbuttons style='display:table-row;'> 
			<td><input type="button" id="but5" value="*" onclick="dis('*')" </td> 
            <td><input type="button" id="but6" value="+" onclick="dis('+')" </td>
            <td><input type="button" id="but7" value="-" onclick="dis('-')" </td>
            <td><input type="button" id="but8" value=""   </td> 
		</tr> 
		
	</table> 
    <p></p>
    
    <table id="answ"> 
		<tr> 
			<td><input type="text" value = "0" id="answer"></td> 
		</tr> 
    </table>

	<table id="clear"> 
		<tr> 
			<td><input type="button" id="clear" value="Try Again" onclick="clr()" </td> 
			<td><input type="button" id="start" value="New Problem" onclick="clrnew()" </td> 
		</tr> 
    </table>
    <script> 
        var val = "";
        var arrAnswr = [];
        var numClickCnt = 0; // count of number button clicks. must be four
        function test() {
            alert("test");
        }
        
        
        function makeProblem() {
        //------------------------------------------------------
        // This function 1) generates 4 non-repeating random numbers 
        // 1 and 9 and sets numeric button row labels and values and
        // 2) generates a math problem with those 4 numbers and displays
        // the answer to the user.
        //------------------------------------------------------
          // generate random numbers
          console.log('makeProblem');
          var arr = [];
          var newarr = [];
          // get array of 4 random numbers between 1-9
          arr = genRandom(9,4);

          // update button values
          document.getElementById('but1').value = arr[0];
          document.getElementById('but2').value = arr[1];
          document.getElementById('but3').value = arr[2];
          document.getElementById('but4').value = arr[3];
          // get 3 random operators for problem
          op1 = getOperator();
          op2 = getOperator();
          op3 = getOperator();
          // shuffle the array of 4 random numbers
          newarr = shuffle(arr);
          var equation = newarr[0] + op1 + newarr[1] + op2 + newarr[2] + op3 + newarr[3];
          alert(equation);
          // incrementally evaluate equation
          var eArr = Array.from(equation);
          var res = eval(eArr[0]);
          res = eval(res + eArr[1] + eArr[2]);
          res = eval(res + eArr[3] + eArr[4]);
          res = eval(res + eArr[5] + eArr[6]);
          console.log(equation + ' = ' + res);
          document.getElementById("targetanswer").value = 'Target Answer = ' + res;

        }  // end of makeProblem function
    
		function dis(butnum) {
            if(butnum == '1' || butnum == '2' || butnum == '3' || butnum == '4') {

                // hide row of number buttons
                document.getElementById('numbuttons').style='display:none;';
              	//show row of operator buttons
                document.getElementById('oprbuttons').style='display:table-row;';
                
                // button pressed was a number so compute running total
                numClickCnt++;
                if(numClickCnt > 4) {
                    alert('game over, stop clicking');
                }
                
                var but = 'but'+butnum;
                val = document.getElementById(but).value;
                // check to see if number already used
                var numUsed = document.getElementById("problem").value;
                if(numUsed.indexOf(val) > -1) {
                    alert('Cannot use a number more than once. Try again');
                    // restore number buttons in view
                    // hide row of operator buttons
                    document.getElementById('oprbuttons').style='display:none;';
              	    //show row of number buttons
                    document.getElementById('numbuttons').style='display:table-row;';
                    return;
                }
                // hide used button
                document.getElementById(but).style.visibility = 'hidden';
                ans = document.getElementById("problem").value
                document.getElementById("problem").value = ans+val;
                arrAnswr.push(val);
                //compute result so far
                var x = arrAnswr.toString();
                var xStr = x.replaceAll(',','');
                console.log('x: ' + xStr);
                var y = math.evaluate(xStr);
                // answer array and push new answer into it
                arrAnswr = [""];;
                arrAnswr.push(y); 
                console.log('val: ' + val + ' arrAnswr: ' + arrAnswr);
                // update answer field on form
                document.getElementById("answer").value = y;
                if(numClickCnt == 4) {
                    alert("game over");
                    // reset counter
                    numClickCnt = 0;
                }

            }
            
            if(butnum == '*' || butnum == '+' || butnum == '-') {
                // hide row of operator buttons
                document.getElementById('oprbuttons').style='display:none;';
              	//show row of number buttons
                document.getElementById('numbuttons').style='display:table-row;';
                if(butnum == '*') {
                    // push operator into answer array
                    arrAnswr.push('*'); 
                    ans = document.getElementById("problem").value;
                    document.getElementById("problem").value = ans +'*';
                    console.log('val after op: ' + '*' + ' arrAnswr: ' + arrAnswr);
                }
                if(butnum == '+') {
                    // push operator into answer array
                    arrAnswr.push('+'); 
                    ans = document.getElementById("problem").value;
                    document.getElementById("problem").value = ans +'+';
                    console.log('val after op: ' + '+' + ' arrAnswr: ' + arrAnswr);
                }
                if(butnum == '-') {
                    // push operator into answer array
                    arrAnswr.push('-'); 
                    ans = document.getElementById("problem").value;
                    document.getElementById("problem").value = ans +'-';
                    console.log('val after op: ' + '-' + ' arrAnswr: ' + arrAnswr);
                }
            }
        } // end of dis() function

		// Function that clears the display 
		function clr() { 
			document.getElementById("problem").value = "";
            document.getElementById("answer").value = "0";
            arrAnswr = [""];

            // show all button rows
            document.getElementById('numbuttons').style='display:table-row;';
            document.getElementById('oprbuttons').style='display:table-row;';
            
            // reset button labels and values
            document.getElementById('but1').style.visibility = 'visible';
            document.getElementById('but2').style.visibility = 'visible';
            document.getElementById('but3').style.visibility = 'visible';
            document.getElementById('but4').style.visibility = 'visible';
            
		}
        // function that clears display and presents new problem
        function clrnew() {
            clr();
            makeProblem();
        }

        function getOperator() {
            // Generate a random arithmetic operator (+, -, *, /)
            var operators = ['+', '-', '*'];
            var operatorIndex = Math.floor(Math.random() * operators.length);
            var operator = operators[operatorIndex];
            return operator;
        }

        function genRandom(range,outputCount) {
        //------------------------------------------------------
        // This function returns non-repeating random numbers
        // where parameter range is the max value and
        // parameter outputCount is the count of random numbers
        // requested.
        //------------------------------------------------------
          var arr = [];
            var result = [];
          for (let i = 1; i <= range; i++) {
            arr.push(i)
          }
          for (i = 1; i <= outputCount; i++) {
            const random = Math.floor(Math.random() * (range - i));
            result.push(arr[random]);
            arr[random] = arr[range - i];
          }
          //Logger.log(result);
          return result;
        }

        function shuffle(array) {
          // This function shuffles the order of the provided
          // array and returns it in a random order
          let currentIndex = array.length,  randomIndex;      
          // While there remain elements to shuffle.
          while (currentIndex > 0) {     
            // Pick a remaining element.
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;        
            // And swap it with the current element.
            [array[currentIndex], array[randomIndex]] = [
              array[randomIndex], array[currentIndex]];
          }
          return array;
        }
     
	</script>
    
</body> 

</html> 
